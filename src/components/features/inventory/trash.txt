
               <div className="rounded-md border bg-card overflow-x-auto">
                  <Table>
                    <TableHeader>
                      <TableRow>
                        <TableHead className="w-20">Image</TableHead>
                        <TableHead>SKU</TableHead>
                        <TableHead>Name & Description</TableHead>
                        <TableHead className="text-center">Qty/Kit</TableHead>
                        <TableHead className="text-center bg-primary/5">
                          <div className="flex flex-col items-center">
                            <span>Estimated Qty</span>
                            <span className="text-xs text-muted-foreground">({assemblyQuantity} kits)</span>
                          </div>
                        </TableHead>
                      </TableRow>
                    </TableHeader>
                    <TableBody>
                      {kit.items.map((item, index) => {
                        const article = articles.find((a) => a.sku === item.articleSku);
                        const estimatedQty = item.quantity * assemblyQuantity;

                        return (
                          <TableRow key={index}>
                            <TableCell>
                              {article?.imageUrl || item.imageUrl ? (
                                <img
                                  src={article?.imageUrl || item.imageUrl}
                                  alt={item.articleName}
                                  className="w-12 h-12 object-cover rounded"
                                />
                              ) : (
                                <div className="w-12 h-12 bg-muted rounded flex items-center justify-center">
                                  <Package className="h-6 w-6 text-muted-foreground" />
                                </div>
                              )}
                            </TableCell>
                            <TableCell className="font-mono text-sm">{item.articleSku}</TableCell>
                            <TableCell>
                              <div>
                                <p className="font-medium">{item.articleName}</p>
                                {item.articleDescription && (
                                  <p className="text-sm text-muted-foreground">{item.articleDescription}</p>
                                )}
                              </div>
                            </TableCell>
                            <TableCell className="text-center">
                              <Badge variant="outline">x{item.quantity}</Badge>
                            </TableCell>
                            <TableCell className="text-center">
                              <Badge variant="secondary" className="font-semibold">
                                {estimatedQty}
                              </Badge>
                            </TableCell>
                          </TableRow>
                        );
                      })}
                    </TableBody>
                  </Table>
                </div>
              
              
              
              
              
              
              
              
              
              {/* BIN Info y Kit Assembly */}
              <div id={`kit-assembly-${kit.id}`} className="grid grid-cols-2 gap-4">
                {/* BIN Information & Stock Breakdown */}
                <div className="p-4 border rounded-lg bg-card">
                  <h4 className="flex items-center mb-3 font-semibold text-sm">
                    <MapPin className="h-4 w-4 mr-2" />
                    BIN Location & Stock
                  </h4>
                  {loadingAvailableBins ? (
                    <div className="flex items-center justify-center p-4">
                      <Loader2 className="h-4 w-4 animate-spin text-muted-foreground mr-2" />
                      <span className="text-sm text-muted-foreground">Loading BIN info...</span>
                    </div>
                  ) : (
                    <div className="space-y-3">
                      {/* BIN Code */}
                      <div className="flex justify-between items-center pb-2 border-b">
                        <span className="text-sm text-muted-foreground">BIN Code:</span>
                        <span className="font-mono font-medium">
                          {assemblyBinCode || kit.binCode || <span className="text-muted-foreground">No BIN Assigned</span>}
                        </span>
                      </div>

                      {/* Total Stock */}
                      <div className="flex justify-between items-center">
                        <span className="text-sm font-semibold">Total Stock:</span>
                        <Badge variant="secondary" className="font-bold text-base">{kit.quantity}</Badge>
                      </div>


                      <div className="space-y-2 pl-2 border-l-2 border-muted">
                        {/* Available */}
                        <div className="flex justify-between items-center">
                          <span className="text-xs text-muted-foreground flex items-center">
                            <Archive className="h-3 w-3 mr-1" />
                            Available:
                          </span>
                          <span className="text-xs font-semibold">{kit.quantityAvailable}</span>
                        </div>

                        {/* On Loan */}
                        <div className="flex justify-between items-center">
                          <span className="text-xs text-muted-foreground flex items-center">
                            <UserCheck className="h-3 w-3 mr-1" />
                            On Loan:
                          </span>
                          <span className="text-xs font-semibold">{kit.quantityLoan}</span>
                        </div>

                        {/* Reserved */}
                        <div className="flex justify-between items-center">
                          <span className="text-xs text-muted-foreground flex items-center">
                            <Lock className="h-3 w-3 mr-1" />
                            Reserved:
                          </span>
                          <span className="text-xs font-semibold">{kit.quantityReserved}</span>
                        </div>
                      </div>

                      {/* Created Date */}
                      <div className="flex justify-between items-center text-xs text-muted-foreground pt-2 border-t">
                        <span>Created:</span>
                        <span>{kit.createdAt}</span>
                      </div>
                    </div>
                  )}
                </div>